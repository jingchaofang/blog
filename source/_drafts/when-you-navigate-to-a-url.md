---
title: 计算机和浏览器做了很多事情
tags:
---

当你访问网址或者刷新网址，虽然时间很短暂，计算机和浏览器做了很多事情

https://zh.nuxtjs.org/guide

https://zeit.co/blog/next

一、域名解析

1. 浏览器搜索自身的DNS缓存，查找成功返回其对应IP地址，失败则进行下一步；以chrome为例，在地址栏中输入```chrome://net-internals/#dns```可以查看dns缓存

2. 当浏览器没有找到缓存或缓存已经失效，就去搜索操作系统的DNS缓存，查找成功返回其对应IP地址，失败则进行下一步；

3. 读取本地的hosts文件，查找成功返回其对应IP地址，失败则进行下一步；
```
C:\Windows\System32\drivers\etc\hosts
```
```
/ect/hosts
```

4. 如果在操作系统中也没有发现缓存DNS记录，则操作系统将这个域名发送至LDNS（本地域名服务器系统，宽带运营商服务器，如果你是电信网，LDNS就在电信那里），LDNS查询自己的缓存（可以说一般绝对大多数情况都能在这里查到），如果查询成功则返回结果，如果查询失败则LDNS（运营商服务器）发起一次迭代DNS解析请求。


a.宽带运营商服务器查看本身的缓存
b.运营商服务器发起一个迭代DNS解析的请求，例如.com会找com的解析服务商,最终会找到域名解析服务商

运营商服务器把结果返回操作系统内核同时缓存起来
操作系统内核把结果返回浏览器
最终浏览器拿到了域名对应的IP地址。

系统将域名发送至 LDNS(本地域名服务器)，查找成功返回其对应 IP 地址，失败则 LDNS 向 Root Name Server(根域名服务器)  发起请求获得域的顶级域名服务器地址，然后依次请求获得各级域名服务器地址，最后获得域名对应 IP 地址；
LDNS 将 IP 地址返回给操作系统并缓存起来；
系统将  IP 地址返回给浏览器并缓存起来；
浏览器获得 IP 地址，发起建立连接的请求。



5.浏览器获得域名对应的IP地址后，发起http三次握手

6.TCP/IP连接建立起来后，浏览器就可以向服务器发送HTTP请求了，使用了比如说，用
HTTP的GET方法请求一个根域里的一个域名，协议可以采用HTTP1.0的一个协议

7.服务器端接受到了这个请求，根据路径参数，经过后端的一些处理之后，把处理后的一个结果的数据返回给浏览器。

8.浏览器拿到了完整的html页面代码，在解析和渲染中这个页面的时候，里面的js、css、图片静态资源，他们同样也是一个http请求，都需要经过上面的主要的七个步骤。

9.浏览器根据拿到的资源对页面进行渲染，最终把一个完整的页面呈现给了用户。


## 参考

http://igoro.com/archive/what-really-happens-when-you-navigate-to-a-url/

https://github.com/alex/what-happens-when

https://github.com/skyline75489/what-happens-when-zh_CN

https://segmentfault.com/a/1190000011938697
